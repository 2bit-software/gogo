//go:build gogo

/*
This file is generated by GoGo. Do not edit.
.............................................@%=====@@..............................................
..........................................@============#@...........................................
........................................@======*====%=====@.........................................
......................................@=======@======+======@.......................................
.....................................-========%-=====@=======@......................................
.....................................@=======@========@======#......................................
.....................................+=====%*==========@======+.....................................
....................................@=======+%@@@@@@%*========@.....................................
....................................+=#@%-:::::::::::::::*@@===:....................................
...................................@+:::::::::::::::::::::::::@@....................................
..................................-:::::::::-+*#####+-::::::::::#...................................
..................................@%@@*====================#@@*:+...................................
................................@================================%=.................................
...............................%===================================@................................
................@@...........@======================================*:..............................
................=@@@@@%-....@#@@@@@@%**********@----%******+*#%@@@#+==-.........%@@.................
.................@@@@@@@@@@@@@@@@@-@********@@*=----@*#+*******@-@@@@@@@@@@@@@@@@@@.................
.................%%@@@@@@@@@@@@@@@--@*********@-----+#*********@-@@@@@@@@@@@@@@@@@..................
.................@@@@@@@@@@*=@@@@@---*@+#*+%@-%-------@*****#*@--@@@@%=%@@@@@@@@@@@.................
..................@@@@@@@@-----@@%-----------%-------@---+#+-----*@@-----@@@@@@@@@:.................
..................-@@@@@@@--@---%+--------@#-@---------@----------#--+%--@@@@@@@@@..................
....................@@@@@@--@*+-#----==------%-----------#@#------@-#=@--@@@@@@@*...................
....................=@@@@@*-@-@-@-----------*---------------------@-#-@-@@@@@@*.....................
.....................:@@@@@-%--%@-----------@---------------------@@-*+-@@@@@@@.....................
........................@@@@---%@-----------@---------------------@@---@@@@@@.......................
............................@---@-----------@---------------------@---@@@@..........................
..............................%@@-----------@---------------------@@#...............................
................................@-----------@---------------------@.................................
................................+-----------@---------------------@.................................
.................................-----------@---------%-----------#.................................
.................................#-----------@-------#-------------.................................
.................................@-----------+*------@-----------*..................................
.................................@-------------@*-=@*------------@..................................
..................................-------------------------------@..................................
..................................@------------------------------=..................................
.................................@@------@---------------@=-----%...................................
...............................#===@----@#@=------------@@@-----@=@.................................
.............................@@====@----%----=%@@@@@@#---------#===%................................
..........................@+=@======@--------------------------@====*#@:............................
........@:.....#*....+@@@===@======#:+--------=@#+#@+---------@*=====#===@...........+%%*...........
....#@=@........%-====%+====%======@.@-----------------------+:@======@====@+%@%*=%.......:+........
...@===@%.....=@=====@=====@=======+..@----------------------#.-=======@====@=====@........+==#*....
.**=*@=============+@======#======%....@--------------------@...@======#=====#+=====@@%%@@@+==-%*...
%=======+@@@@@@@%==+*=============@.....@------------------#....@=======@=====@@@==========+@@===%:.
===================@==============@......@---------------%:.....@==============@=====***==========-@
===================*==============@.......%%------------@.......@==============*====================
==================@===============@........*----------+@........@===============@===================
==================@=================........*----------@........@===============@===================
==================@================@........@----------@........#===============@===================
==================@================*:.......@@-------#@........@================%===================
===++==+==========%@@@@@@@@@@@======@......@.@#%@@@%%..@......@#================#=============*=====
===@==%=====================@========@....@..-%#####@...@...:@@======@==*%%%%#+=-==========#===@====
===@=-@===================@===========@%.::...@#####@....#.@.@=========@====================@==%====
===+=@=================+@=-============@.@.....@%###@....#..@==========-=@===================@==#===
==*==@==============+@+-================#+....@######@.....@===============+@+===============@==@===
*/

package main

import (
	"errors"
	"fmt"
	"os"
	"path/filepath"

	"github.com/2bit-software/gogo"
)

func main() {
	gogo.VersionFlag = &gogo.BoolFlag{
		Name:    "version",
		Aliases: []string{""},
		Usage:   "print only the version",
	}
	app := &gogo.App{
		Name:    filepath.Base(os.Args[0]),
		Usage:   "{{.RootCmd.Short}}",
		Version: "1.0.0",
		Flags: []gogo.Flag{
			&gogo.StringFlag{
				Name:    "config",
				Aliases: []string{"c"},
				Usage:   "config file (default is ./config.yaml)",
				EnvVars: []string{"CONFIG"},
			},
			&gogo.BoolFlag{
				Name:    "verbose",
				Aliases: []string{"v"},
				Usage:   "enable verbose mode",
				EnvVars: []string{"VERBOSE"},
			},
			{{- if .RootCmd.GoFlags}}
			{{- range .RootCmd.GoFlags}}
			&gogo.{{ Capitalize .Type}}Flag{
				Name:    "{{.Name}}",
				{{- if ne .Short 0}}
				Aliases: []string{"{{ ByteToString .Short}}"},
				{{- end}}
				Usage:   "{{.Help}}",
				{{- if .HasDefault}}
				Value:   {{.Default}},
				{{- end}}
				EnvVars: []string{"{{.Name | ToUpper}}"},
			},
			{{- end}}
			{{- end}}
		},
		Before: func(c *gogo.CliContext) error {
			// Configuration file handling similar to initConfig()
			configFile := c.String("config")

			if configFile != "" {
				// Load specific config file
				// Note: We would need an equivalent to viper here
				// This is a placeholder for the config loading logic
			} else {
				// Load default config
				// Note: We would need an equivalent to viper here
				// This is a placeholder for the config loading logic
			}

			return nil
		},
		Commands: []*gogo.Command{},
		{{- if ne .RootCmd.Name ""}}
		Action: func(c *gogo.CliContext) error {
			{{- template "runCmdUrfave" .RootCmd }}
		},
		{{- end}}
	}

	{{- if .SubCommands}}
	// add the commands
	{{ range $sub := .SubCommands }}
	{{ LowerFirstLetter $sub.Name }}Cmd := {{ template "subCmdUrfave" $sub }}
	app.Commands = append(app.Commands, {{ LowerFirstLetter $sub.Name }}Cmd)
	{{ end }}
	{{- end}}

	// Run the app
	err := app.Run(os.Args)
	if err != nil {
		fmt.Println(err)
		os.Exit(1)
	}
}

{{- if .SubCommands }}
{{ template "stringToIntFunc" }}
{{- end }}

// detectArgumentRequirements validates that all required arguments are provided
func detectArgumentRequirements(args []string, c *gogo.CliContext) bool {
	// if there are no required args, just accept the input
	if len(args) == 0 {
		return true
	}
	for _, arg := range args {
		if arg == "" {
			continue
		}
		// Different from viper.IsSet - we have to check if the flag is set
		if !c.IsSet(arg) {
			return false
		}
	}
	return true
}